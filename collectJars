#!/bin/sh
mversion=1.1
version=$mversion.0

base=`pwd`
echo ----------------- SikuliX collecting jars in $base 

source=$base/Setup/target

dist=$base/../SikuliX-Setup
if [ -e $dist ]; then
  rm -f -R $dist
fi
mkdir $dist 
mkdir $dist/Downloads 

log=$dist/collectjars-log.txt

echo --- version --- $version
echo --- major version --- $mversion
echo --- version --- $version >>$log
echo --- major version --- $mversion >>$log

echo ----------------- SourceBase $base >>$log
echo ----------------- running Maven clean install --- takes some time ...
mvn clean install >>$log

# ----------- Setup
echo --- collecting jars
echo --- collecting jars >>$log
cd $source >>$log
java -jar sikulixsetup-$version-plain.jar noSetup >>$log
cd $base
ls -l $source >>$log

# ----------- Setup
echo --- copy Setup
echo --- copy Setup >>$log
cp $source/sikulixsetup*.jar $dist/sikulixsetup-$mversion.jar
ls -l $dist >>$log

# ----------- Jars
echo --- copy Jars 
echo --- copy Jars >>$log
cp $source/Downloads/* $dist/Downloads
ls -l $dist/Downloads >>$log

echo ----------- final content of $dist
ls -lR $dist
echo ----------- SikuliX collectjars end -----------
